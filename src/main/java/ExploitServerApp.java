import java.io.IOException;
import java.net.InetSocketAddress;
import java.net.URL;

/**
 * Will start an instance of {@link ExploitServer} running on either provided parameters, or defaults.
 */
public class ExploitServerApp {

    private static final String DEFAULT_HOSTNAME = "127.0.0.1";
    private static final int DEFAULT_PORT = 8000;

    public static void main(String[] args) throws IOException {
        final InetSocketAddress listeningAddress = getListeningAddress(args);
        new ExploitServer(listeningAddress);
    }

    /**
     * If host and port are available on command line, use that, else apply defaults,
     * #DEFAULT_HOSTNAME and #DEFAULT_PORT.
     *
     * @param args command line args
     * @return Listening address.
     */
    private static InetSocketAddress getListeningAddress(String[] args) {
        try {
            // just some basic input sanitizing
            final URL asURL = new URL(String.format("http://%s:%d", args[0], Integer.parseInt(args[1])));
            return new InetSocketAddress(asURL.getHost(), asURL.getPort());
        } catch (Exception e) {
            return new InetSocketAddress(DEFAULT_HOSTNAME, DEFAULT_PORT);
        }
    }

}
