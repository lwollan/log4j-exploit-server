import java.io.ByteArrayOutputStream;

class HexUtils {

    private static final char[] HEX_CHARS = "0123456789ABCDEF".toCharArray();

    public static String toHex(byte[] bytes) {
        char[] buffer = new char[bytes.length * 2];
        for (int index = 0; index < bytes.length; index++) {
            int clean = bytes[index] & 0xFF;
            buffer[index * 2] = HEX_CHARS[clean >>> 4];
            buffer[index * 2 + 1] = HEX_CHARS[clean & 0x0F];
        }
        return new String(buffer);
    }

    public static byte[] fromHex(String hexDump) {
        ByteArrayOutputStream buffer = new ByteArrayOutputStream();
        for (int i = 0; i < hexDump.length(); i += 2) {
            buffer.write(toByte(hexDump.charAt(i), hexDump.charAt(i + 1)));
        }

        return buffer.toByteArray();
    }

    private static byte toByte(char high, char low) {
        return (byte) ((Character.digit(high, 16) << 4) + Character.digit(low, 16));
    }

}
